{"version":3,"sources":["TextEditor/index.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","useState","socket","setSocket","quill","setQuill","documentId","useParams","id","useEffect","s","io","disconnect","handler","delta","oldDelta","source","emit","on","off","updateContents","once","document","setContents","enable","interval","setInterval","getContents","clearInterval","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","exact","path","to","uuidv4","ReactDOM","render","StrictMode","getElementById"],"mappings":"yNAMMA,EAAkB,CACtB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAGY,SAASC,IAAc,IAAD,EACPC,qBADO,mBAC5BC,EAD4B,KACpBC,EADoB,OAETF,qBAFS,mBAE5BG,EAF4B,KAErBC,EAFqB,KAGzBC,EAAeC,cAAnBC,GAENC,qBAAU,WACR,IAAMC,EAAIC,aAAG,yBAEb,OADAR,EAAUO,GACH,WACLA,EAAEE,gBAEH,IAEHH,qBAAU,WACR,GAAKP,GAAWE,EAAhB,CACA,IAAMS,EAAU,SAACC,EAAOC,EAAUC,GACjB,SAAXA,GACJd,EAAOe,KAAK,eAAgBH,IAK9B,OAFAV,EAAMc,GAAG,cAAeL,GAEjB,WACLT,EAAMe,IAAI,cAAeN,OAE1B,CAACX,EAAQE,IAEZK,qBAAU,WACR,GAAKP,GAAWE,EAAhB,CACA,IAAMS,EAAU,SAACC,GACfV,EAAMgB,eAAeN,IAKvB,OAFAZ,EAAOgB,GAAG,kBAAmBL,GAEtB,WACLX,EAAOiB,IAAI,kBAAmBN,OAE/B,CAACX,EAAQE,IAEZK,qBAAU,WACHP,GAAWE,IAEhBF,EAAOmB,KAAK,iBAAiB,SAACC,GAC5BlB,EAAMmB,YAAYD,GAClBlB,EAAMoB,YAERtB,EAAOe,KAAK,eAAgBX,MAC3B,CAACJ,EAAQE,EAAOE,IAEnBG,qBAAU,WACR,GAAKP,GAAWE,EAAhB,CACJ,IAAMqB,EAAWC,aAAY,WAC7BxB,EAAOe,KAAK,gBAAiBb,EAAMuB,iBAtDV,KAwDzB,OAAO,WACHC,cAAcH,OAGd,CAACvB,EAAQE,IAGX,IAAMyB,EAAaC,uBAAY,SAACC,GAC9B,GAAe,MAAXA,EAAJ,CACAA,EAAQC,UAAY,GAEpB,IAAMC,EAASX,SAASY,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAC1BK,MAAO,OACPC,QAAS,CAAEC,QAAShD,KAEtB4C,EAAEK,UACFL,EAAEM,QAAQ,cACVrC,EAAS+B,MACR,IACH,OACE,qBAAKO,UAAU,YAAYC,IAAKf,EAAhC,yB,oBCrEWgB,MAjBf,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,IAAlB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,eAA5B,SACE,cAACjD,EAAD,QAGJ,cAAC,IAAD,CAAO+C,KAAK,iBAAZ,SACE,cAAC/C,EAAD,Y,MCdVkD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF9B,SAAS+B,eAAe,W","file":"static/js/main.19f56f32.chunk.js","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport Quill from \"quill\";\r\nimport { io } from \"socket.io-client\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nconst TOOLBAR_OPTIONS = [\r\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n  [{ font: [] }],\r\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n  [\"bold\", \"italic\", \"underline\"],\r\n  [{ color: [] }, { background: [] }],\r\n  [{ script: \"sub\" }, { script: \"super\" }],\r\n  [{ align: [] }],\r\n  [\"image\", \"blockquote\", \"code-block\"],\r\n  [\"clean\"],\r\n];\r\nconst SAVE_INTERVAL_MS = 2000\r\nexport default function TextEditor() {\r\n  const [socket, setSocket] = useState();\r\n  const [quill, setQuill] = useState();\r\n  let { id: documentId } = useParams();\r\n\r\n  useEffect(() => {\r\n    const s = io(\"http://localhost:3001\");\r\n    setSocket(s);\r\n    return () => {\r\n      s.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!socket || !quill) return;\r\n    const handler = (delta, oldDelta, source) => {\r\n      if (source !== \"user\") return;\r\n      socket.emit(\"send-changes\", delta);\r\n    };\r\n\r\n    quill.on(\"text-change\", handler);\r\n\r\n    return () => {\r\n      quill.off(\"text-change\", handler);\r\n    };\r\n  }, [socket, quill]);\r\n\r\n  useEffect(() => {\r\n    if (!socket || !quill) return;\r\n    const handler = (delta) => {\r\n      quill.updateContents(delta);\r\n    };\r\n\r\n    socket.on(\"receive-changes\", handler);\r\n\r\n    return () => {\r\n      socket.off(\"receive-changes\", handler);\r\n    };\r\n  }, [socket, quill]);\r\n\r\n  useEffect(() => {\r\n    if (!socket || !quill) return;\r\n\r\n    socket.once(\"load-document\", (document) => {\r\n      quill.setContents(document);\r\n      quill.enable();\r\n    });\r\n    socket.emit(\"get-document\", documentId);\r\n  }, [socket, quill, documentId]);\r\n\r\n  useEffect(()=>{\r\n    if (!socket || !quill) return;\r\nconst interval = setInterval(()=>{\r\nsocket.emit(\"save-document\", quill.getContents())\r\n}, SAVE_INTERVAL_MS)\r\nreturn ()=>{\r\n    clearInterval(interval)\r\n}\r\n\r\n  },[socket, quill])\r\n\r\n\r\n  const wrapperRef = useCallback((wrapper) => {\r\n    if (wrapper == null) return;\r\n    wrapper.innerHTML = \"\";\r\n\r\n    const editor = document.createElement(\"div\");\r\n    wrapper.append(editor);\r\n    const q = new Quill(editor, {\r\n      theme: \"snow\",\r\n      modules: { toolbar: TOOLBAR_OPTIONS },\r\n    });\r\n    q.disable();\r\n    q.setText('Loading...')\r\n    setQuill(q);\r\n  }, []);\r\n  return (\r\n    <div className=\"container\" ref={wrapperRef}>\r\n      text editor\r\n    </div>\r\n  );\r\n}\r\n","import TextEditor from \"./TextEditor\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path=\"/\">\n          <Redirect to={`/documents/${uuidv4()}`}>\n            <TextEditor />\n          </Redirect>\n        </Route>\n        <Route path=\"/documents/:id\">\n          <TextEditor />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport \"./styles.css\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}